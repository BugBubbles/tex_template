\ProvidesPackage{customFormat}
\usepackage{
  enumitem,			% Custom Item Bullets
  multicol,			% Use Multi-columns
  xcolor,			    % Use Colors
  abstract,
  geometry,
  booktabs,    %提供三线表命令
  zhnumber,    %使用中文数字编号的宏包
  titlesec,   %使用自定义的标题格式和间距
  fancyhdr,   %使用页眉页脚
  appendix,  %使用附录
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% 所有的格式设置都在这里 %%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%% 设置Python风格的伪代码格式 %%%%
\usepackage[formats]{listings}
\lstset{
    % language=Python,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue},
    stringstyle=\color{red},
    commentstyle=\color{green},
    numbers=left,
    numberstyle=\tiny\color{gray},
    stepnumber=1,
    numbersep=5pt,
    backgroundcolor=\color{white},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    frame=single,
    rulecolor=\color{black},
    tabsize=4,
    captionpos=b,
    breaklines=true,
    breakatwhitespace=false,
    title=\lstname,
    escapeinside={},
    keywordstyle={[2]\color{orange}},
    belowskip=-3em,
    % morekeywords={as, None, with, yield},
    % deletekeywords={...},
}
% %%%% 设置 摘要 属性 %%%%
\renewcommand{\abstractname}{摘\quad 要}
\renewcommand{\abstractnamefont}{\sanhao\heiti}
\renewcommand{\abstracttextfont}{\xiaosihao\songti}
% %%%% 设置 附录 属性 %%%%
\renewcommand{\appendixname}{附\quad 录}
\renewcommand{\appendixtocname}{附\quad 录}
\renewcommand{\appendixpagename}{\rm\sanhao\heiti\centering{附\quad 录}}
% 设置 附录的section 属性
%% 注意：子附录的标题将不出现在目录中
\newcounter{subappendix}
\setcounter{subappendix}{1}
\renewcommand{\subsectionmark}[1]{\markboth{\Alph{subappendix}\ #1}{}}
\newcommand{\subappendix}[1]{
  \ifnum\value{subappendix}>1
    \newpage
  \fi
  {\noindent\sihao\heiti 附录\Alph{subappendix}\quad #1}
  \stepcounter{subappendix}
  \par
  }

% \titlecontents{subappendix}[2em]{\wuhao\vspace{-1em}}{\contentslabel{2em}}{\hspace*{2em}}{~\titlerule*[0.6pc]{.}~\contentspage}
% \titleformat{\subappendix}[block]{\sanhao\heiti\centering}{\Alph{subappendix}}{0.5em}{}[]
% \titlespacing{\subappendix}{0pt}{0\baselineskip}{0\baselineskip}


% %%%% 设置 目录 属性 %%%%
%%目录标题格式的设定
\renewcommand{\contentsname}{\sanhao\heiti 目\qquad 录}
% \setlength\parskip{.5\baselineskip}%正文的行间距
%%目录行间距的设定
\renewcommand\tableofcontents{%
    \setlength\parskip{.5\baselineskip}% 控制目录内的行间距
    \centerline{\normalfont\Large\bfseries\sffamily\contentsname
        \@mkboth{%
           \MakeUppercase\contentsname}{\MakeUppercase\contentsname}}%
        \vskip 2ex%
    \@starttoc{toc}% 恢复正文的行间距
    \setlength\parskip{.5\baselineskip}% 注意，这里需要与下面的行间距设置保持一致
}

%用计数器成功实现section和subsection不相同标号的办法
\newcounter{mysection}
\setcounter{mysection}{1}

%%目录缩进的设定
\titlecontents{section}[2em]{\heiti\wuhao\vspace{0em}}{\contentslabel[第\zhnum{mysection}章\stepcounter{mysection}]{4em}}{\hspace*{-4em}}{~\titlerule*[0.6pc]{.}~\contentspage}
\titlecontents{subsection}[2em]{\wuhao\vspace{-1em}}{\contentslabel{2em}}{\hspace*{2em}}{~\titlerule*[0.6pc]{.}~\contentspage}

\titlecontents{subsubsection}[4em]{\wuhao\vspace{-2em}}{\contentslabel{3em}}{\hspace*{-2em}}{~\titlerule*[0.6pc]{.}~\contentspage}

% \titlecontents{paragraph}[11em]{\wuhao}{\contentslabel{4em}}{\hspace*{-2em}}{~\titlerule*[0.6pc]{.}~\contentspage}
% %%%% 设置 part 属性 %%%%
% \makeatletter
% \renewcommand\part{\@startsection{part}{1}{\z@}%
% {-1.5ex \@plus -.5ex \@minus -.2ex}%
% {.5ex \@plus .1ex}%
% {\normalfont\sihao\heiti}}
% \makeatother
%%%% 设置 section 属性 %%%%

% \makeatletter
% \renewcommand\section{\@startsection{section}{1}{\z@}%
% {-1.5ex \@plus -.5ex \@minus -.2ex}%
% {.5ex \@plus .1ex}%
% {\normalfont\sihao\heiti}}
% \makeatother
\renewcommand{\sectionmark}[1]{\markboth{第\zhnum{section}章\ #1}{}}
\titleformat{\section}[block]{\sanhao\heiti\centering}{第\zhnum{section}章}{0.5em}{}[]
% 设置章标题左边距、上下空行间距
\titlespacing{\section}{0pt}{0\baselineskip}{0\baselineskip}
% %%%% 设置 subsection 属性 %%%%
% \makeatletter
% \renewcommand\subsection{\@startsection{subsection}{1}{\z@}%
% {-1.25ex \@plus -.5ex \@minus -.2ex}%
% {.4ex \@plus .1ex}%
% {\normalfont\xiaosihao\hwzs}}
% \makeatother
\renewcommand{\subsectionmark}[1]{\markboth{\arabic{section}.\arabic{subsection}\ #1}{}}
\titleformat{\subsection}[block]{\sihao\heiti}{\arabic{section}.\arabic{subsection}}{0.5em}{}[]
% 设置节标题左边距、上下空行间距
\titlespacing{\subsection}{0pt}{0\baselineskip}{0\baselineskip}
% %%%% 设置 subsubsection 属性 %%%%
% \makeatletter
% \renewcommand\subsubsection{\@startsection{subsubsection}{1}{\z@}%
% {-1ex \@plus -.5ex \@minus -.2ex}%
% {.3ex \@plus .1ex}%
% {\normalfont\xiaosihao\textbf\songti}}
% \makeatother
\renewcommand{\subsubsectionmark}[1]{\markboth{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}\ #1}{}}
\titleformat{\subsubsection}[block]{\xiaosihao\songti\bfseries}{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}{0.5em}{}[]
% 设置小节标题左边距、上下空行间距
\titlespacing{\subsubsection}{0pt}{0\baselineskip}{0\baselineskip}

%%对enumerate类型的编号的设定
\renewcommand{\labelenumi}{\theenumi 、}

%------------------------------------------%
%页面
%------------------------------------------%\
% 设置页边距
\geometry{left=25mm,right=25mm,top=25mm,bottom=25mm}
%%%% 设置行间距与段落间距 %%%%
\linespread{1.5}
% \setlength{\parskip}{0.5\baselineskip}

%%%% 段落首行缩进两个字 %%%%
\makeatletter
\let\@afterindentfalse\@afterindenttrue
\@afterindenttrue
\makeatother
\setlength{\parindent}{2em}  %中文缩进两个汉字位
%------------------------------------------%
%页眉页脚
%------------------------------------------%
\fancypagestyle{beihang}{%
\fancyhf{}%
\fancyhead[CO]{北京航空航天大学硕士学位论文}%
\fancyhead[CE]{\leftmark}%
\renewcommand{\headrulewidth}{0.5pt} % 设置页眉线宽度
}
%------------------------------------------%
%图表框名设置
%------------------------------------------%
\DeclareCaptionLabelSeparator{quad}{\quad}
\captionsetup[figure]{labelfont=rm,name=图,labelformat=simple,labelseparator=quad}
\captionsetup[table]{labelfont=rm,name=表,labelformat=simple,labelseparator=quad}
% \captionsetup[tabular]{labelfont=rm,name=表,labelformat=simple,labelseparator=punk}
%子图设置
\renewcommand{\thesubfigure}{图\hspace{0.5em}\thefigure.\arabic{subfigure}}
\makeatletter
\renewcommand{\p@subfigure}{}
\renewcommand{\@thesubfigure}{\thesubfigure. \hskip\subfiglabelskip}
\makeatother
%------------------------------------------%
%数学公式编号
%按章号.公式号编号
%------------------------------------------%
\numberwithin{equation}{section}
%------------------------------------------%
%下划线
%------------------------------------------%
\makeatletter
\newcommand\dlmu[2][8cm]{\hskip1pt\underline{\hb@xt@ #1{\hss#2\hss}}\hskip3pt}
\makeatother
%------------------------------------------%
%参考文献
%------------------------------------------%
\renewcommand{\refname}{参考文献}
%------------------------------------------%
%日期落款格式
%------------------------------------------%
\renewcommand{\today}{\heiti{\number\year 年 \number\month 月 \number\day 日}}
\newcommand{\now}{\heiti{\number\year 年 \number\month 月}}
% \renewcommand{\today}{\heiti{\number\year 年 \number\month 月 }}